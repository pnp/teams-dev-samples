// This file is automatically generated by Teams Toolkit.
// The teamsfx tasks defined in this file require Teams Toolkit version >= 5.0.0.
// See https://aka.ms/teamsfx-tasks for details on how to customize each task.
{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Start Teams App Locally",
            "dependsOn": [
                "Validate prerequisites",
                "Provision",
                "Deploy",
                "Start application"
            ],
            "dependsOrder": "sequence"
        },
        {
            "label": "Validate prerequisites",
            "type": "teamsfx",
            "command": "debug-check-prerequisites",
            "args": {
                "prerequisites": [
                    "nodejs",
                    "m365Account",
                    "portOccupancy"
                ],
                "portOccupancy": [
                    53000
                ]
            }
        },
        {
            "label": "Provision",
            "type": "teamsfx",
            "command": "provision",
            "args": {
                "env": "local"
            }
        },
        {
            "label": "Deploy",
            "type": "teamsfx",
            "command": "deploy",
            "args": {
                "env": "local"
            }
        },
        {
            "label": "Start application",
            "dependsOn": [
                "Start frontend",
                // "Start backend"
            ]
        },
        {
            "label": "Start frontend",
            "type": "shell",
            "command": "npm run dev:teamsfx",
            "isBackground": true,
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": {
                "pattern": {
                    "regexp": "^.*$",
                    "file": 0,
                    "location": 1,
                    "message": 2
                },
                "background": {
                    "activeOnStart": true,
                    "beginsPattern": ".*",
                    "endsPattern": "Compiled|Failed|compiled|failed"
                }
            }
        },
        // {
        //     "label": "Start backend",
        //     "type": "shell",
        //     "command": "npm run dev:teamsfx",
        //     "isBackground": true,
        //     "options": {
        //         "cwd": "${workspaceFolder}/api",
        //         "env": {
        //             "PATH": "${workspaceFolder}/devTools/func:${env:PATH}"
        //         }
        //     },
        //     "windows": {
        //         "options": {
        //             "env": {
        //                 "PATH": "${workspaceFolder}/devTools/func;${env:PATH}"
        //             }
        //         }
        //     },
        //     "problemMatcher": {
        //         "pattern": {
        //             "regexp": "^.*$",
        //             "file": 0,
        //             "location": 1,
        //             "message": 2
        //         },
        //         "background": {
        //             "activeOnStart": true,
        //             "beginsPattern": "^.*(Job host stopped|signaling restart).*$",
        //             "endsPattern": "^.*(Worker process started and initialized|Host lock lease acquired by instance ID).*$"
        //         }
        //     },
        //     "presentation": {
        //         "reveal": "silent"
        //     }
        // },
        // {
        //     "type": "func",
        //     "label": "func: host start",
        //     "command": "host start",
        //     "problemMatcher": "$func-node-watch",
        //     "isBackground": true,
        //     "dependsOn": "npm build (functions)",
        //     "options": {
        //         "cwd": "${workspaceFolder}/api"
        //     }
        // },
        // {
        //     "type": "shell",
        //     "label": "npm build (functions)",
        //     "command": "npm run build",
        //     "dependsOn": [
        //         "func: extensions install",
        //         "npm install (functions)"
        //     ],
        //     "problemMatcher": "$tsc",
        //     "options": {
        //         "cwd": "${workspaceFolder}/api"
        //     }
        // },
        // {
        //     "type": "shell",
        //     "label": "npm install (functions)",
        //     "command": "npm install",
        //     "options": {
        //         "cwd": "${workspaceFolder}/api"
        //     }
        // },
        // {
        //     "type": "shell",
        //     "label": "npm prune (functions)",
        //     "command": "npm prune --production",
        //     "dependsOn": "npm build (functions)",
        //     "problemMatcher": [],
        //     "options": {
        //         "cwd": "${workspaceFolder}/api"
        //     }
        // }
    ]
}
